<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.1">
  <Form id="pos3052fm" width="550" height="730" titletext="New Form" background="white" onload="pos3052fm_onload">
    <Layouts>
      <Layout height="730" width="550">
        <Div id="Div02" taborder="0" left="15" top="13" width="520" height="642" cssclass="div_card_shadow" formscrollbartype="none none" formscrolltype="none" fittocontents="height" text="">
          <Layouts>
            <Layout>
              <Static id="Static01_01" taborder="0" text="---------------------------------------------------------------------------------" left="15" top="59" width="495" height="40" cssclass="sta_subtitle"/>
              <Static id="Static01" taborder="1" text="결제방법" left="15" top="84" width="120" height="34" cssclass="sta_default"/>
              <Static id="Static01_00" taborder="2" text="판매금액" left="15" top="117" width="120" height="34" cssclass="sta_default"/>
              <Static id="Static01_02" taborder="3" text="현금" left="364" top="84" width="120" height="34" cssclass="sta_defaultRight"/>
              <Static id="Static01_03" taborder="4" text="할인금액" left="15" top="150" width="120" height="34" cssclass="sta_default"/>
              <Static id="Static01_00_01_00" taborder="5" text="승인일시" left="15" top="184" width="120" height="34" cssclass="sta_default"/>
              <Static id="staDate" taborder="6" left="340" top="185" width="145" height="34" font="15px/normal &quot;Segoe UI&quot;,&quot;Malgun Gothic&quot;" textAlign="right"/>
              <Static id="Static01_01_00_01" taborder="7" text="---------------------------------------------------------------------------------" left="15" top="363" width="495" height="40" cssclass="sta_subtitle"/>
              <Static id="Static01_04" taborder="8" text="대표" left="15" top="382" width="120" height="34" cssclass="sta_default"/>
              <Static id="Static01_00_02" taborder="9" text="사업자 등록번호" left="15" top="415" width="120" height="34" cssclass="sta_default"/>
              <Static id="Static01_03_01" taborder="10" text="대표번호" left="15" top="448" width="120" height="34" cssclass="sta_default"/>
              <Static id="Static01_00_01_02" taborder="11" text="주소" left="15" top="481" width="120" height="34" cssclass="sta_default"/>
              <Static id="Static01_00_01_00_01" taborder="12" text="가맹점 번호" left="15" top="514" width="120" height="34" cssclass="sta_default"/>
              <Static id="Static01_02_00" taborder="13" left="365" top="382" width="120" height="34" cssclass="sta_defaultRight" text="대표"/>
              <Static id="Static01_00_00_01" taborder="14" text="사업자 등록번호" left="365" top="415" width="120" height="34" cssclass="sta_defaultRight"/>
              <Static id="Static01_03_00_00" taborder="15" text="대표번호" left="365" top="448" width="120" height="34" cssclass="sta_defaultRight"/>
              <Static id="Static01_00_01_01_00" taborder="16" text="주소" left="151" top="481" width="334" height="34" cssclass="sta_defaultRight"/>
              <Static id="Static01_00_01_00_00_00" taborder="17" text="가맹점 번호" left="365" top="514" width="120" height="34" cssclass="sta_defaultRight"/>
              <Static id="Static01_01_00_01_00" taborder="18" text="---------------------------------------------------------------------------------" left="15" top="544" width="495" height="40" cssclass="sta_subtitle"/>
              <Static id="Static01_05" taborder="19" text="하단 문구" left="15" top="559" width="470" height="64" cssclass="sta_default"/>
              <MaskEdit id="MaskEdit00" taborder="20" left="9" top="37" width="121" height="32" border="0px solid" postfixtext="원" format="#,###" font="18px/normal &quot;Segoe UI&quot;,&quot;Malgun Gothic&quot;" textAlign="left"/>
              <MaskEdit id="MaskEdit00_00" taborder="21" top="333" width="143" height="32" border="0px solid" postfixtext="원" format="#,###" font="18px/normal &quot;Segoe UI&quot;,&quot;Malgun Gothic&quot;" textAlign="right" right="28"/>
              <MaskEdit id="MaskEdit01" taborder="22" left="370" top="117" width="120" height="34" border="0px none" format="#,###" postfixtext="원" textAlign="right" font="15px/normal &quot;Segoe UI&quot;,&quot;Malgun Gothic&quot;"/>
              <MaskEdit id="MaskEdit01_00" taborder="23" left="370" top="151" width="120" height="34" border="0px none" format="#,###" postfixtext="원" textAlign="right" font="15px/normal &quot;Segoe UI&quot;,&quot;Malgun Gothic&quot;"/>
              <Div id="Div00" taborder="24" left="0" top="218" width="520" height="119" border="1px solid black" text="" fittocontents="height">
                <Layouts>
                  <Layout>
                    <Static id="Static01_01_00_00" taborder="0" text="---------------------------------------------------------------------------------" left="8" top="9" width="495" height="19" cssclass="sta_subtitle"/>
                    <Static id="Static01_01_00" taborder="1" text="---------------------------------------------------------------------------------" left="8" top="91" width="495" height="19" cssclass="sta_subtitle"/>
                    <Grid id="grdList" taborder="2" left="14" top="34" width="484" binddataset="gdsSalesDetail" autofittype="col" background="transparent" border="0px none" bottom="24">
                      <Formats>
                        <Format id="default">
                          <Columns>
                            <Column size="80"/>
                            <Column size="80"/>
                          </Columns>
                          <Rows>
                            <Row size="24"/>
                          </Rows>
                          <Band id="body">
                            <Cell text="bind:prod_nm" expr="expr:prod_nm + &quot; X &quot; + count"/>
                            <Cell col="1" text="bind:price" textAlign="right"/>
                          </Band>
                        </Format>
                      </Formats>
                    </Grid>
                  </Layout>
                </Layouts>
              </Div>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static01" taborder="1" text="가게 이름" left="31" top="20" width="120" height="30" cssclass="sta_default"/>
        <Static id="Static01_00_00_00" taborder="2" left="36" top="349" width="154" height="40" cssclass="sta_title" text="합계"/>
        <Button id="btn_print" taborder="3" text="출력" top="675" width="78" height="51" cssclass="btn_outline" onclick="Div00_btn_edit_onclick" left="193"/>
        <Button id="btn_cancel" taborder="4" text="닫기" top="675" width="78" height="51" cssclass="btn_outline" left="291" onclick="btn_cancel_onclick"/>
        <Div id="Div00_00" taborder="5" left="730" top="257" width="520" height="305" border="1px solid black" text=""/>
      </Layout>
    </Layouts>
    <Script type="xscript5.1"><![CDATA[this.btn_cancel_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	this.parent.parent.close("");
};

this.pos3052fm_onload = function(obj:nexacro.Form,e:nexacro.LoadEventInfo)
{	
	// 승인시간 보여주기
	var objApp = nexacro.getApplication();
    var sSaleId = objApp.gdsSalesMaster.getColumn(0, "sale_id"); // 첫 번째 행의 SALE_ID 가져오기
	
    if (sSaleId) {
        // 문자열 자르기 및 포맷팅
        var sFormattedDate = sSaleId.substring(0, 4) + "-" 
                           + sSaleId.substring(4, 6) + "-" 
                           + sSaleId.substring(6, 8) + " " 
                           + sSaleId.substring(8, 10) + ":" 
                           + sSaleId.substring(10, 12) + ":" 
                           + sSaleId.substring(12, 14);
        
        // Static 컴포넌트에 값 세팅 (컴포넌트 ID가 staDate라고 가정)
        this.Div02.form.staDate.text=sFormattedDate;
    }
	
	this.fn_adjustReceiptLayout();
	
// 	// 그리드가 fittocontents="height"인 경우 실제 계산된 높이를 가져옴
//     var nGridHeight = this.Div02.form.grdList.getOffsetHeight();
//      this.Div02.form.grdList.height.
//     // 부모 Div(divReceipt)의 높이를 그리드 높이에 맞춰 조절 (여백 100 포함)
//     this.parent.height=nGridHeight + 100;
};


this.fn_adjustReceiptLayout = function()
{
    //  그리드의 실제 늘어난 높이 계산
    var nGridHeight = this.Div02.form.Div00.form.grdList.getOffsetHeight();

    //  그리드를 감싸고 있는 중간 Div의 높이를 그리드에 맞춤
    this.Div02.form.Div00.height=nGridHeight;
	
//     //  하단 정보 Div의 위치를 중간 Div 바로 아래로 이동
//     var nGap = 20; // 여백
//     var nNextTop = this.Div02.getOffsetBottom() + nGap;
//     this.divBottomInfo.top=nNextTop;
//     
//     //  마지막으로 큰 Div의 높이를 하단 Div의 바닥 위치에 맞춤
//     var nFinalHeight = this.divBottomInfo.getOffsetBottom() + 40; // 하단 여백 포함
//     this.height=nFinalHeight;
    
    //  팝업 프레임 크기도 내용에 맞게 조정
    /*this.getOwnerFrame().set_height(nFinalHeight + 150);*/
	this.getOwnerFrame().height=150+nGridHeight;
};
]]></Script>
    <Bind>
      <BindItem id="item0" compid="Static01" propid="text" datasetid="gdsReceiptInfo" columnid="shop_name"/>
      <BindItem id="item1" compid="Div02.form.Static01_02_00" propid="text" datasetid="gdsReceiptInfo" columnid="rep_name"/>
      <BindItem id="item2" compid="Div02.form.Static01_00_00_01" propid="text" datasetid="gdsReceiptInfo" columnid="biz_reg_no"/>
      <BindItem id="item3" compid="Div02.form.Static01_03_00_00" propid="text" datasetid="gdsReceiptInfo" columnid="rep_tel"/>
      <BindItem id="item4" compid="Div02.form.Static01_00_01_01_00" propid="text" datasetid="gdsReceiptInfo" columnid="addr_basic"/>
      <BindItem id="item5" compid="Div02.form.Static01_00_01_00_00_00" propid="text" datasetid="gdsReceiptInfo" columnid="merchant_no"/>
      <BindItem id="item6" compid="Div02.form.Static01_05" propid="text" datasetid="gdsReceiptInfo" columnid="bottom_msg"/>
      <BindItem id="item7" compid="Div02.form.MaskEdit00" propid="value" datasetid="gdsSalesMaster" columnid="pay_amt"/>
      <BindItem id="item9" compid="Div02.form.MaskEdit01" propid="value" datasetid="gdsSalesMaster" columnid="total_amt"/>
      <BindItem id="item10" compid="Div02.form.MaskEdit01_00" propid="value" datasetid="gdsSalesMaster" columnid="discount_amt"/>
      <BindItem id="item8" compid="Div02.form.MaskEdit00_00" propid="value" datasetid="gdsSalesMaster" columnid="pay_amt"/>
      <BindItem id="item11" compid="Div02.form.Static01_02" propid="text" datasetid="gdsSalesMaster" columnid="pay_method"/>
    </Bind>
    <Objects/>
  </Form>
</FDL>
